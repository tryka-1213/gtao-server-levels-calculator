<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="GTAO Levelling Calculator" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tryka-1213.github.io/gtao-server-levels-calculator/" />
    <meta property="og:image" content="https://cdn.discordapp.com/attachments/984857793473433678/995458751786127430/unknown.png" />
    <link rel="icon" type="image/png" href="https://cdn.discordapp.com/avatars/554326065527390209/5488de98811172b240d433e11c1dcacc.webp?size=1024">
    <meta property="og:description" content="A GUI for calculating anything level/xp/message based for the GTAO Discord Server" />
    <meta name="theme-color" content="#ffef79">
    <title>GTAO Levelling Calculator</title>
</head>

<link rel="stylesheet" href="styles.css">
<script src="index.js"></script>
<script defer>
    window.onload = () => {
        // Setup enter key event listener
        let inputBoxes = document.querySelectorAll("[id$='input']")

        for (const element of inputBoxes) {
            let elementId = element.id.split("-")[0]
            element.addEventListener("keypress", (event) => {
                if ((event.key === "Enter") && (!event.shiftKey)) {
                    event.preventDefault()
                    document.getElementById(`${elementId}-btn`).click()
                }
            })
        }
    }

    function capitalizeFirstLetter(string) {
        return string.charAt(0).toUpperCase() + string.slice(1);
    }

    function extractids() {
        let input = document.getElementById("extractids-input").value
        let newMembersOnly = document.getElementById("newmembersonly").children[0].className.baseVal == "checkbox-on" ? true : false
        let extracted = extract(input, newMembersOnly)

        document.getElementById("extractids-result").textContent = ""
        
        if (extracted.length > 0) {
            // display IDs
            document.getElementById("extractids-input").value = `${extracted.join("\n")}`
            document.getElementById("extractids-result").style.background = "#2f402d"
            // display how many IDs were extracted
            document.getElementById("extractids-result").textContent = `${extracted.length} ID${extracted.length > 1 ? "s" : ""}`
        } else {
            // nothing extracted
            document.getElementById("extractids-result").style.background = "#402d2d"
            document.getElementById("extractids-result").textContent = "No IDs found"
        }

        
    }

    function xptolevel() {
        let input = parseInt(document.getElementById("xptolevel-input").value)  
        let level = xpToLevel(input)
        
        document.getElementById("xptolevel-result").innerText = `Level: ${level}`
    }

    function leveltoxp() {
        let input = parseInt(document.getElementById("leveltoxp-input").value)  
        let xp = levelToXp(input)

        document.getElementById("leveltoxp-result").innerText = `XP: ${xp}`
    }

    function leveltomsg() {
        let input = parseInt(document.getElementById("leveltomsg-input").value)  
        let prestige = document.getElementById("prestigecheck-leveltomsg").children[0].className.baseVal == "checkbox-on" ? true : false
        let msg = levelToMessageCount(input, prestige)

        document.getElementById("leveltomsg-result").innerText = `Message Count (approx): ${msg}`
    }

    function msgtolevel() {
        let input = parseInt(document.getElementById("msgtolevel-input").value)  
        let prestige = document.getElementById("prestigecheck-msgtolevel").children[0].className.baseVal == "checkbox-on" ? true : false
        let msg = messageCountToLevel(input, prestige)

        document.getElementById("msgtolevel-result").innerText = `Level (approx): ${msg}`
    }

    function msgtoxp() {
        let input = parseInt(document.getElementById("msgtoxp-input").value)  
        let prestige = document.getElementById("prestigecheck-msgtoxp").children[0].className.baseVal == "checkbox-on" ? true : false
        let msg = messageCountToXp(input, prestige)

        document.getElementById("msgtoxp-result").innerText = `XP (approx): ${msg}`
    }

    function logtojson() {
        let input = document.getElementById("logtojson-input").value
        
        if (!input) {
            document.getElementById("logtojson-result").style.background = "#402d2d"
            document.getElementById("logtojson-result").textContent = "No log link found"
            document.getElementById("logtojson-result").style.color = "white"
            return
        }
        
        fetch("https://api.canterdale.com/logparser",
            {
                method: "post",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({"loglink": input})
            }  
        )
        .then(resp => resp.json())
        .then(r => {
            document.getElementById("logtojson-result").style.color = "white"
            document.getElementById("logtojson-resultraw").style.color = "white"

            if (r.error) {
                console.log(r)
                if (document.getElementById("logtojson-result").textContent == "No log link found") return
                document.getElementById("logtojson-result").textContent = "Invalid log link"
                document.getElementById("logtojson-result").style.background = "#402d2d"
                document.getElementById("logtojson-result").attributes.href = "#"
            } else {
                console.log(r)

                // JSON -- only give message json
                document.getElementById("logtojson-result").setAttribute("href", "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(r.messages.all)))

                document.getElementById("logtojson-result").setAttribute("download", `Log_#${r.thread.threadId}.json`)
                document.getElementById("logtojson-result").style.background = "#2f402d"

                // show file to download
                document.getElementById("logtojson-result").textContent = `Download ${capitalizeFirstLetter(r.thread.type)} thread #${r.thread.threadId}`

                
                // RAW
                document.getElementById("logtojson-resultraw").setAttribute("href", input)
                document.getElementById("logtojson-resultraw").setAttribute("target", "_blank")
                document.getElementById("logtojson-resultraw").style.background = "#2f402d"

                // show file to download
                document.getElementById("logtojson-resultraw").textContent = `View raw`
                
            }
            return
        })
    }


    const toggleButton = (elId) => {
        if (document.getElementById(elId).children[0].className.baseVal == "checkbox-off") {
            document.getElementById(elId).innerHTML = `<svg class="checkbox-on" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#39a65a" class="bi bi-toggle-on" viewBox="0 0 16 16"><path d="M5 3a5 5 0 0 0 0 10h6a5 5 0 0 0 0-10H5zm6 9a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>`
        } else {
            document.getElementById(elId).innerHTML = `<svg class="checkbox-off" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-toggle-off" viewBox="0 0 16 16"><path d="M11 4a4 4 0 0 1 0 8H8a4.992 4.992 0 0 0 2-4 4.992 4.992 0 0 0-2-4h3zm-6 8a4 4 0 1 1 0-8 4 4 0 0 1 0 8zM0 8a5 5 0 0 0 5 5h6a5 5 0 0 0 0-10H5a5 5 0 0 0-5 5z"/></svg>`
        }

    }
</script>
<body>
    <div class="calculator-container">
        <div class="xptolevel align-txt">
            <span class="strong-font">XP to Level</span><br>
            <input id="xptolevel-input" class="xptolevel-input" type="number">
            <button id="xptolevel-btn" onclick="xptolevel()">
                <svg aria-hidden="true" role="img" class="sendIcon-1HcEzu" width="16" height="16" viewBox="0 0 16 16"><path d="M8.2738 8.49222L1.99997 9.09877L0.349029 14.3788C0.250591 14.691 0.347154 15.0322 0.595581 15.246C0.843069 15.4597 1.19464 15.5047 1.48903 15.3613L15.2384 8.7032C15.5075 8.57195 15.6781 8.29914 15.6781 8.00007C15.6781 7.70101 15.5074 7.4282 15.2384 7.29694L1.49839 0.634063C1.20401 0.490625 0.852453 0.535625 0.604941 0.749376C0.356493 0.963128 0.259941 1.30344 0.358389 1.61563L2.00932 6.89563L8.27093 7.50312C8.52405 7.52843 8.71718 7.74125 8.71718 7.99531C8.71718 8.24938 8.52406 8.46218 8.27093 8.4875L8.2738 8.49222Z" fill="#959af4"></path></svg>
            </button>

            <br><span id="xptolevel-result"></span>
        </div>
        <div class="leveltoxp align-txt">
            <span class="strong-font">Level to XP</span><br>
            <input id="leveltoxp-input" type="number">
            <button id="leveltoxp-btn" onclick="leveltoxp()">
                <svg aria-hidden="true" role="img" class="sendIcon-1HcEzu" width="16" height="16" viewBox="0 0 16 16"><path d="M8.2738 8.49222L1.99997 9.09877L0.349029 14.3788C0.250591 14.691 0.347154 15.0322 0.595581 15.246C0.843069 15.4597 1.19464 15.5047 1.48903 15.3613L15.2384 8.7032C15.5075 8.57195 15.6781 8.29914 15.6781 8.00007C15.6781 7.70101 15.5074 7.4282 15.2384 7.29694L1.49839 0.634063C1.20401 0.490625 0.852453 0.535625 0.604941 0.749376C0.356493 0.963128 0.259941 1.30344 0.358389 1.61563L2.00932 6.89563L8.27093 7.50312C8.52405 7.52843 8.71718 7.74125 8.71718 7.99531C8.71718 8.24938 8.52406 8.46218 8.27093 8.4875L8.2738 8.49222Z" fill="#959af4"></path></svg>
            </button>
            <br><span id="leveltoxp-result"></span>
        </div>
        <div class="leveltomsg align-txt">
            <span class="strong-font">Level to Message Count</span><br>
            <input id="leveltomsg-input" type="number">
            <button id="leveltomsg-btn" onclick="leveltomsg()">
                <svg aria-hidden="true" role="img" class="sendIcon-1HcEzu" width="16" height="16" viewBox="0 0 16 16"><path d="M8.2738 8.49222L1.99997 9.09877L0.349029 14.3788C0.250591 14.691 0.347154 15.0322 0.595581 15.246C0.843069 15.4597 1.19464 15.5047 1.48903 15.3613L15.2384 8.7032C15.5075 8.57195 15.6781 8.29914 15.6781 8.00007C15.6781 7.70101 15.5074 7.4282 15.2384 7.29694L1.49839 0.634063C1.20401 0.490625 0.852453 0.535625 0.604941 0.749376C0.356493 0.963128 0.259941 1.30344 0.358389 1.61563L2.00932 6.89563L8.27093 7.50312C8.52405 7.52843 8.71718 7.74125 8.71718 7.99531C8.71718 8.24938 8.52406 8.46218 8.27093 8.4875L8.2738 8.49222Z" fill="#959af4"></path></svg>
            </button>
            <br>  
            <span class="strong-font">Prestige?</span>
            <button class="checkbox-btn" id="prestigecheck-leveltomsg" onclick="toggleButton('prestigecheck-leveltomsg')">
                <svg class="checkbox-off" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-toggle-off" viewBox="0 0 16 16">
                    <path d="M11 4a4 4 0 0 1 0 8H8a4.992 4.992 0 0 0 2-4 4.992 4.992 0 0 0-2-4h3zm-6 8a4 4 0 1 1 0-8 4 4 0 0 1 0 8zM0 8a5 5 0 0 0 5 5h6a5 5 0 0 0 0-10H5a5 5 0 0 0-5 5z"/>
                </svg>
            </button>
            <br><span id="leveltomsg-result"></span>
        </div>
        <div class="msgtoxp align-txt">
            <span class="strong-font">Message Count to XP</span><br>
            <input id="msgtoxp-input" type="number">
            <button id="msgtoxp-btn" onclick="msgtoxp()">
                <svg aria-hidden="true" role="img" class="sendIcon-1HcEzu" width="16" height="16" viewBox="0 0 16 16"><path d="M8.2738 8.49222L1.99997 9.09877L0.349029 14.3788C0.250591 14.691 0.347154 15.0322 0.595581 15.246C0.843069 15.4597 1.19464 15.5047 1.48903 15.3613L15.2384 8.7032C15.5075 8.57195 15.6781 8.29914 15.6781 8.00007C15.6781 7.70101 15.5074 7.4282 15.2384 7.29694L1.49839 0.634063C1.20401 0.490625 0.852453 0.535625 0.604941 0.749376C0.356493 0.963128 0.259941 1.30344 0.358389 1.61563L2.00932 6.89563L8.27093 7.50312C8.52405 7.52843 8.71718 7.74125 8.71718 7.99531C8.71718 8.24938 8.52406 8.46218 8.27093 8.4875L8.2738 8.49222Z" fill="#959af4"></path></svg>
            </button>
            <br>  
            <span class="strong-font">Prestige?</span>
            <button class="checkbox-btn" id="prestigecheck-msgtoxp" onclick="toggleButton('prestigecheck-msgtoxp')">
                <svg class="checkbox-off" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-toggle-off" viewBox="0 0 16 16">
                    <path d="M11 4a4 4 0 0 1 0 8H8a4.992 4.992 0 0 0 2-4 4.992 4.992 0 0 0-2-4h3zm-6 8a4 4 0 1 1 0-8 4 4 0 0 1 0 8zM0 8a5 5 0 0 0 5 5h6a5 5 0 0 0 0-10H5a5 5 0 0 0-5 5z"/>
                </svg>
            </button>
            <br><span id="msgtoxp-result"></span>
        </div>
        <div class="msgtolevel align-txt">
            <span class="strong-font">Message Count to Level</span><br>
            <input id="msgtolevel-input" type="number">
            <button id="msgtolevel-btn" onclick="msgtolevel()">
                <svg aria-hidden="true" role="img" class="sendIcon-1HcEzu" width="16" height="16" viewBox="0 0 16 16"><path d="M8.2738 8.49222L1.99997 9.09877L0.349029 14.3788C0.250591 14.691 0.347154 15.0322 0.595581 15.246C0.843069 15.4597 1.19464 15.5047 1.48903 15.3613L15.2384 8.7032C15.5075 8.57195 15.6781 8.29914 15.6781 8.00007C15.6781 7.70101 15.5074 7.4282 15.2384 7.29694L1.49839 0.634063C1.20401 0.490625 0.852453 0.535625 0.604941 0.749376C0.356493 0.963128 0.259941 1.30344 0.358389 1.61563L2.00932 6.89563L8.27093 7.50312C8.52405 7.52843 8.71718 7.74125 8.71718 7.99531C8.71718 8.24938 8.52406 8.46218 8.27093 8.4875L8.2738 8.49222Z" fill="#959af4"></path></svg>
            </button>
            <br>  
            <span class="strong-font">Prestige?</span>
            <button class="checkbox-btn" id="prestigecheck-msgtolevel" onclick="toggleButton('prestigecheck-msgtolevel')">
                <svg class="checkbox-off" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-toggle-off" viewBox="0 0 16 16">
                    <path d="M11 4a4 4 0 0 1 0 8H8a4.992 4.992 0 0 0 2-4 4.992 4.992 0 0 0-2-4h3zm-6 8a4 4 0 1 1 0-8 4 4 0 0 1 0 8zM0 8a5 5 0 0 0 5 5h6a5 5 0 0 0 0-10H5a5 5 0 0 0-5 5z"/>
                </svg>
            </button>
            <br><span id="msgtolevel-result"></span>
        </div>
        <div class="extractids align-txt">
            <span class="extractids-text strong-font">Extract IDs</span><br>
            <!-- <input id="extractids-input" type="text"> -->
            <textarea id="extractids-input" placeholder="Enter join logs (zep or hep) here"></textarea>


            <br>  
            <span class="strong-font">New accounts only?</span>
            <button class="checkbox-btn" id="newmembersonly" onclick="toggleButton('newmembersonly')">
                
                <svg class="checkbox-off" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-toggle-off" viewBox="0 0 16 16">
                    <path d="M11 4a4 4 0 0 1 0 8H8a4.992 4.992 0 0 0 2-4 4.992 4.992 0 0 0-2-4h3zm-6 8a4 4 0 1 1 0-8 4 4 0 0 1 0 8zM0 8a5 5 0 0 0 5 5h6a5 5 0 0 0 0-10H5a5 5 0 0 0-5 5z"/>
                </svg>
            </button><br>
            <button id="extractids-btn" onclick="extractids()">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#959af4" class="bi bi-check-square-fill" viewBox="0 0 20 20">
                    <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm10.03 4.97a.75.75 0 0 1 .011 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.75.75 0 0 1 1.08-.022z"/>
                  </svg>
            </button>
            <br><span id="extractids-result"></span>
        </div>
        <div class="logtojson align-txt">
            <span class="strong-font">Modmail/Appeal Log to JSON</span><br>
            <input id="logtojson-input" class="logtojson-input" type="text">
            <button id="logtojson-btn" onclick="logtojson()">
                <svg aria-hidden="true" role="img" class="sendIcon-1HcEzu" width="16" height="16" viewBox="0 0 16 16"><path d="M8.2738 8.49222L1.99997 9.09877L0.349029 14.3788C0.250591 14.691 0.347154 15.0322 0.595581 15.246C0.843069 15.4597 1.19464 15.5047 1.48903 15.3613L15.2384 8.7032C15.5075 8.57195 15.6781 8.29914 15.6781 8.00007C15.6781 7.70101 15.5074 7.4282 15.2384 7.29694L1.49839 0.634063C1.20401 0.490625 0.852453 0.535625 0.604941 0.749376C0.356493 0.963128 0.259941 1.30344 0.358389 1.61563L2.00932 6.89563L8.27093 7.50312C8.52405 7.52843 8.71718 7.74125 8.71718 7.99531C8.71718 8.24938 8.52406 8.46218 8.27093 8.4875L8.2738 8.49222Z" fill="#959af4"></path></svg>
            </button>
            <br><br><a id="logtojson-result"></a>
            <br><a id="logtojson-resultraw"></a>
        </div>
    </div>
    <a class="discord" href="https://discord.gg/gtao" target="_blank"></a>
</body>
</html>